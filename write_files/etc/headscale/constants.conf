# Headscale VPS Constants Configuration
# Centralized timeouts, thresholds, and magic numbers
# Update these values carefully and test before deploying to production

# API Key Management
readonly API_KEY_EXPIRATION_DAYS=90
readonly API_KEY_WARNING_THRESHOLD_DAYS=14

# Systemd
readonly SYSTEMD_MIN_VERSION=250

# Service Startup
readonly SERVICE_START_RETRY_COUNT=30
readonly SERVICE_START_RETRY_DELAY=1  # seconds

# Health Check Thresholds
readonly CERT_EXPIRY_WARNING_DAYS=14
readonly DISK_WARNING_THRESHOLD_PCT=80

# Fail2ban Configuration
readonly FAIL2BAN_SSH_MAXRETRY=4
readonly FAIL2BAN_SSH_FINDTIME="10m"
readonly FAIL2BAN_SSH_BANTIME="24h"

readonly FAIL2BAN_OIDC_MAXRETRY=5
readonly FAIL2BAN_OIDC_FINDTIME="10m"
readonly FAIL2BAN_OIDC_BANTIME="12h"

readonly FAIL2BAN_AUTHKEY_MAXRETRY=5
readonly FAIL2BAN_AUTHKEY_FINDTIME="10m"
readonly FAIL2BAN_AUTHKEY_BANTIME="12h"

readonly FAIL2BAN_RECIDIVE_MAXRETRY=3
readonly FAIL2BAN_RECIDIVE_FINDTIME="1d"
readonly FAIL2BAN_RECIDIVE_BANTIME="1w"

# Logging
readonly LOG_ROTATION_DAYS=7
readonly CADDY_LOG_SIZE="10mb"
readonly CADDY_LOG_KEEP=5